# ุฏุงฺฉูููุช ูู : Best Practices ูุงูุชูุฑูฺฏ ุฒุฑุณุงุฎุช ู ุงููุช ุจุง Zabbix


## ุชุฌูุฒุงุช ุชุญุช ูุงูุชูุฑูฺฏ

- โ ุณุฑูุฑูุง HP ุจุง ILO
- โ ูุฌุงุฒโุณุงุฒูุง ESXi ู vCenter
- โ ูุงุฑูุงูโูุง FortiGate
- โ ุณูฺโูุง Cisco
- โ ูุงุดูโูุง ูุฌุงุฒ (VMs)

---

## ุณุฑูุฑ HP (ILO )

| ุขุชู                                | ุฑูุด ูุงูุชูุฑูฺฏ | ุงุจุฒุงุฑ                  |
| --------------------------------------- | --------------------------- | --------------------------- |
| ุฑูุดู/ุฎุงููุด ุจูุฏู            | IPMI                        | Zabbix IPMI Template        |
| ุฏูุงุ ููุ ูพุงูุฑ                | IPMI / SNMP                 | HP MIB                      |
| ูุตุฑู CPU, RAM, Disk                 | Zabbix Agent                | Template OS Linux / Windows |
| ูุถุนุช RAID ู ูุงุฑุฏูุง         | SNMP                        | HP Insight Tools            ||

---

## vCenter ู ESXi

| ุขุชู                      | ุฑูุด ูุงูุชูุฑูฺฏ | ุงุจุฒุงุฑ                 |
| ----------------------------- | --------------------------- | -------------------------- |
| ูุถุนุช ูุงุณุชโูุง     | vSphere API                 | Template VMware            |
| ูุถุนุช VMูุง             | API                         | Template VMware            |
| ุงุณุชูุงุฏู ููุงุจุน     | API                         | vmware.vm.resource metrics |
| Snapshotูุง ูุฏู     | Auto-Discovery              | Template VMware            |
| ุฑุฎุฏุงุฏูุง vMotion / HA | Event Polling               | vCenter Alarm              |

---

## FortiGate Firewall

| ุขุชู                  | ุฑูุด ูุงูุชูุฑูฺฏ | ุงุจุฒุงุฑ              |
| ------------------------- | --------------------------- | ----------------------- |
| CPU ู RAM                | SNMP                        | Template SNMP FortiGate |
| Interfaceูุง             | SNMP + Discovery            | FortiGate IF Metrics    |
| ุชุนุฏุงุฏ Sessions       | SNMP                        | fgSysSesCount           |
| ูุถุนุช VPN            | SNMP                        | IPsec/SSL Metrics       |

---

## ุณูฺ Cisco

| ุขุชู                  | ุฑูุด ูุงูุชูุฑูฺฏ | ุงุจุฒุงุฑ                 |
| ------------------------- | --------------------------- | -------------------------- |
| ูุถุนุช ูพูุฑุชโูุง | SNMP + LLD                  | ifOperStatus               |
| Errors / CRC              | SNMP                        | Interface Counters         |
| ุฏูุง                    | SNMP                        | CiscoEnvMon                |
| STP / Routing             | SNMP                        | STP/Routing Tables         |

---

## ูุงุดูโูุง ูุฌุงุฒ (VMs)

| ุขุชู                    | ุฑูุด ูุงูุชูุฑูฺฏ | ุงุจุฒุงุฑ                         |
| --------------------------- | --------------------------- | ---------------------------------- |
| ุฑูุดู ุจูุฏู           | Ping                        | Zabbix ICMP                        |
| ููุงุจุน ูุตุฑู       | Zabbix Agent                | Template OS Linux / Windows        |
| ูุถุนุช ุณุฑูุณโูุง | Agent                       | service.info[,state] |
| ูุถุง ุฏุณฺฉ           | Agent + Discovery           | vfs.fs.size[*]                     |

---

# ๐ก๏ธ ูุงูุชูุฑูฺฏ ุงููุช VMูุง

## 1. Authentication Monitoring

| ุขุชู                           | ููุน  | ฺฉูุฏ / ูุฑูุงู                                              | ุชูุถุญ                                    |
| ---------------------------------- | ------- | ------------------------------------------------------------------ | --------------------------------------------- |
| ูุฑูุฏ ูุงูููู SSH          | Log     | `log[/var/log/auth.log, Failed password, UTF-8]`                   | ุจุฑุฑุณ ูุงฺฏ ูุฑูุฏูุง ูุงูููู |
| ูุฑูุฏ root                      | Log     | `log[/var/log/auth.log, Accepted password for root, UTF-8]`        | ูุงูุชูุฑ ูุฑูุฏ root                  |
| ูุฑูุฏ ูุงูููู ููุฏูุฒ | Log     | `logrt["C:\\Windows\\System32\\winevt\\Logs\\Security.evtx",4625]` | ูุงฺฏ ูุฑูุฏ ุฏุฑ ููุฏูุฒ             |
| ุชูุงุดโูุง ุฒุงุฏ ูุฑูุฏ | Trigger | ุจุด ุงุฒ ต ุจุงุฑ ุฏุฑ ต ุฏููู                           | ุชุดุฎุต Brute Force                        |

## 2. System Change Monitoring

| ุขุชู                    | ููุน     | ูุฑูุงู                                                    | ุชูุถุญ                        |
| --------------------------- | ---------- | ------------------------------------------------------------- | --------------------------------- |
| ุชุบุฑ ูุงู sudoers | Text       | `vfs.file.contents[/etc/sudoers]`                             | ุชุดุฎุต ุชุบุฑุงุช ููู  |
| ฺฉุงุฑุจุฑ ุฌุฏุฏ         | Log        | `log[/var/log/auth.log, new user]`                            | ุจุฑุฑุณ ุงุถุงูู ุดุฏู user |
| ูุงุฑูุงู ูุนุงูุ   | Text       | `system.run[ufw status]` ุง `system.run[firewalld --state]` | ฺฺฉ ุงููุช                 |

## 3. Network & Firewall Monitoring

| ุขุชู                   | ููุน  | ูุฑูุงู                                                                                                                  | ุชูุถุญ                              |
| -------------------------- | ------- | --------------------------------------------------------------------------------------------------------------------------- | --------------------------------------- |
| ุชุนุฏุงุฏ ูพูุฑุช ุจุงุฒ | Numeric | `system.run[ss -tuln                                                                                                        | wc -l]`                                 |
| ูพูุฑุช SSH               | Net.TCP | `net.tcp.port[22]`                                                                                                          | ุจุณุชู ุจูุฏู ุง ูุดุฏุงุฑ       |

## 4. Update & Patch

| ุขุชู                        | ููุน  | ูุฑูุงู                                      | ุชูุถุญ                    |
| ------------------------------- | ------- | ----------------------------------------------- | ----------------------------- |
| ุจุฑูุฒุฑุณุงู ูููฺฉุณ | Numeric | `system.run[apt list --upgradable               | wc -l]`                       |
| ุขูพุฏุช ููุฏูุฒ         | Script  | PowerShell Script                               | ุจุฑุฑุณ ุจุฑูุฒุฑุณุงู |

## 5. Suspicious Behavior

| ุขุชู            | ููุน     | ูุฑูุงู                      | ุชูุถุญ                           |
| ------------------- | ---------- | ------------------------------- | ------------------------------------ |
| uptime              | Uptime     | `system.uptime`                 | ุชุดุฎุต ุฑุจูุช ูุงฺฏูุงู |
| ุฏุณฺฉ ูพุฑ       | Numeric    | `vfs.fs.size[/,pfree]`          | ุชูุฏุฏ ูพุฑููุฑููุณ          |
| ุฒูุงู ุณุณุชู | Text       | `system.run[ntpq -pn            | head -n 10]`                         |

---


